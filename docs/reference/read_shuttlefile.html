<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read and process TRAFx Shuttle Files — read_shuttlefile • recrtools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Read and process TRAFx Shuttle Files — read_shuttlefile"><meta property="og:description" content="This function reads one or more TRAFx Shuttle Files (.txt) from a single file
or a folder containing multiple files, and returns processed data frames for
analysis. It extracts both the hourly counts recorded by each counter as well
as the download metadata (e.g., serial numbers, timestamps, and counter mode)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">recrtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/read_TRAFx_shuttlefile.html">Read data from TRAFx shuttlefiles</a>
    </li>
    <li>
      <a href="../articles/recode_by_dict.html">Recoding Survey 'Other' Responses</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read and process TRAFx Shuttle Files</h1>

    <div class="hidden name"><code>read_shuttlefile.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function reads one or more TRAFx Shuttle Files (.txt) from a single file
or a folder containing multiple files, and returns processed data frames for
analysis. It extracts both the hourly counts recorded by each counter as well
as the download metadata (e.g., serial numbers, timestamps, and counter mode).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_shuttlefile</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  tz <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/timezones.html" class="external-link">Sys.timezone</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  return <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"both"</span>, <span class="st">"counts"</span>, <span class="st">"header"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Character. The file path to either a single <code>.txt</code> shuttle file
or a folder containing multiple shuttle files.</p></dd>


<dt id="arg-tz">tz<a class="anchor" aria-label="anchor" href="#arg-tz"></a></dt>
<dd><p>Character. Time zone for timestamp conversion. Defaults to your
computer's time zone.</p></dd>


<dt id="arg-return">return<a class="anchor" aria-label="anchor" href="#arg-return"></a></dt>
<dd><p>Character. Determines what the function returns. Options are:</p><ul><li><p>"counts" - only the hourly counts data frame.</p></li>
<li><p>"header" - only the metadata/header data frame.</p></li>
<li><p>"both" (default) - a <strong>list</strong> containing two data frames: <code>counts</code>
and <code>header</code>.</p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the <code>return</code> argument:</p><ul><li><p>If <code>return = "counts"</code>: a single data frame with all hourly counts.</p></li>
<li><p>If <code>return = "header"</code>: a single data frame with counter metadata.</p></li>
<li><p>If <code>return = "both"</code>: a <strong>list</strong> with two components:</p><dl><dt>counts</dt>
<dd><p>Data frame with all hourly counts.</p></dd>

<dt>header</dt>
<dd><p>Data frame with counter metadata.</p></dd>


</dl></li>
</ul><p>This means that when you choose <code>return = "both"</code>, the function will give you
one object, and you can access the counts data frame with <code>result$counts</code> and
the header data frame with <code>result$header</code>.</p>
<p>The structure of each data frame is as follows:</p>
<p>If <code>return = "counts"</code> or <code>return = "both"</code>, the <code>counts</code> data frame has:</p><dl><dt>counter</dt>
<dd><p>Character. Name of the counter unit.</p></dd>

<dt>serial</dt>
<dd><p>Character. Serial number of the counter.</p></dd>

<dt>dateTime</dt>
<dd><p>POSIXct. Combined date and hour of the count. Time zone as specified by <code>tz</code>.</p></dd>

<dt>date</dt>
<dd><p>Date. The date of the count.</p></dd>

<dt>time</dt>
<dd><p>Character. Hour portion of the count (HH:MM).</p></dd>

<dt>count1</dt>
<dd><p>Numeric. First count channel (if only one sensor attached, all counts are in this column).</p></dd>

<dt>count2</dt>
<dd><p>Numeric. Second count channel (if a second sensor is available; 0 if not used).</p></dd>


</dl><p>If <code>return = "header"</code> or <code>return = "both"</code>, the <code>header</code> data frame has:</p><dl><dt>counter</dt>
<dd><p>Character. Name of the counter unit.</p></dd>

<dt>mode</dt>
<dd><p>Character. Counter mode (e.g. Infrared (IR+) for pedestrian configuration).</p></dd>

<dt>serial</dt>
<dd><p>Character. Serial number of the counter.</p></dd>

<dt>volt</dt>
<dd><p>Character or numeric. Battery voltage at the time of download.</p></dd>

<dt>downloadTime</dt>
<dd><p>POSIXct. Timestamp when the file was downloaded from the counter.</p></dd>

<dt>startTime</dt>
<dd><p>POSIXct. Timestamp when the counter recording period started.</p></dd>

<dt>dockTime</dt>
<dd><p>POSIXct. Timestamp when the counter was physically downloaded via the dock/shuttle (if applicable).</p></dd>


</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Read a single file (using included example data)</span></span></span>
<span class="r-in"><span><span class="va">example_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ShuttleFile_EXAMPLE.TXT"</span>, package <span class="op">=</span> <span class="st">"recrtools"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Process the file and return both counts and header information</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">read_shuttlefile</span><span class="op">(</span><span class="va">example_file</span>, return <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access each part of the result</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">counts</span>   <span class="co"># Hourly counts data frame</span></span></span>
<span class="r-in"><span><span class="va">header</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">header</span>   <span class="co"># Metadata / header data frame</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Read all ShuttleFiles in a data folder using an RStudio project structure</span></span></span>
<span class="r-in"><span><span class="co"># Assume your RStudio project has the following folder structure:</span></span></span>
<span class="r-in"><span><span class="co">#   Trail Counter Project/   # Your RStudio project folder</span></span></span>
<span class="r-in"><span><span class="co">#       ├── data/            # raw ShuttleFiles go here</span></span></span>
<span class="r-in"><span><span class="co">#       │    └── trafx_downloads/</span></span></span>
<span class="r-in"><span><span class="co">#       ├── scripts/         # R scripts/functions</span></span></span>
<span class="r-in"><span><span class="co">#       ├── results/         # processed data or figures</span></span></span>
<span class="r-in"><span><span class="co">#       └── ...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The "data/trafx_downloads/" path is relative to the project root.</span></span></span>
<span class="r-in"><span><span class="va">folder_path</span> <span class="op">&lt;-</span> <span class="st">"data/trafx_downloads/"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Process all ShuttleFiles in the folder</span></span></span>
<span class="r-in"><span><span class="va">all_data</span> <span class="op">&lt;-</span> <span class="fu">read_shuttlefile</span><span class="op">(</span><span class="va">folder_path</span>, return <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract the individual data frames from the list</span></span></span>
<span class="r-in"><span><span class="va">counts_df</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">counts</span></span></span>
<span class="r-in"><span><span class="va">header_df</span> <span class="op">&lt;-</span> <span class="va">all_data</span><span class="op">$</span><span class="va">header</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Read a specific ShuttleFile by path</span></span></span>
<span class="r-in"><span><span class="co"># Can provide a relative or absolute path to a single file</span></span></span>
<span class="r-in"><span><span class="va">single_file</span> <span class="op">&lt;-</span> <span class="st">"data/trafx_downloads/TRAFX_2024-06-15.TXT"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Only return the hourly counts</span></span></span>
<span class="r-in"><span><span class="va">counts_only</span> <span class="op">&lt;-</span> <span class="fu">read_shuttlefile</span><span class="op">(</span><span class="va">single_file</span>, return <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Colin Leslie.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

